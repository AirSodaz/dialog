@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Spectral:wght@300;400;700&family=Inter:wght@300;400;600&display=swap');

@import "tailwindcss";
@plugin "@tailwindcss/typography";

@theme {
  --font-serif: "Merriweather", "Spectral", serif;
  --font-sans: "Inter", "Geist", sans-serif;

  /* Semantic Color Mapping */
  --color-paper: var(--bg-paper);
  --color-sidebar: var(--bg-sidebar);
  --color-modal: var(--bg-modal);
  --color-surface: var(--bg-surface);
  --color-surface-hover: var(--bg-surface-hover);

  --color-ink: var(--fg-ink);
  --color-muted: var(--fg-muted);
  --color-subtle: var(--fg-subtle);

  --color-border-base: var(--border-base);
  --color-border-focus: var(--border-focus);
}

@layer base {
  :root {
    /* Light Theme (Warm) */
    --bg-paper: #FDFBF7;
    --bg-sidebar: #F7F5F0;
    --bg-modal: #FFFFFF;
    --bg-surface: #F5F5F4; /* stone-100 */
    --bg-surface-hover: #E7E5E4; /* stone-200 */

    --fg-ink: #2D2A26;
    --fg-muted: #78716C; /* stone-500 */
    --fg-subtle: #A8A29E; /* stone-400 */

    --border-base: #E7E5E4; /* stone-200 */
    --border-focus: #A8A29E; /* stone-400 */
  }

  .dark {
    /* Dark Theme (Warm Charcoal) */
    --bg-paper: #1E1C1A;
    --bg-sidebar: #252321;
    --bg-modal: #23211f;
    --bg-surface: #2A2826;
    --bg-surface-hover: #353331;

    --fg-ink: #EBE5E0;
    --fg-muted: #A8A29E;
    --fg-subtle: #57534E; /* stone-600 */

    --border-base: #44403C; /* stone-700 */
    --border-focus: #57534E; /* stone-600 */
  }

  body {
    @apply bg-paper text-ink font-sans transition-colors duration-200;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-serif;
  }
}

/* Custom Typography Overrides for Notion/Typora-like spacing */
@layer components {

  /* General Prose Spacing - Notion-like */
  .prose {
    font-size: 16px;
    line-height: 1.625;
    max-width: none;
  }

  /* 
     Using !important to override Tailwind Typography's 
     opinionated sibling selectors (like h1 + p).
  */

  .prose p {
    margin-top: 12px !important;
    margin-bottom: 12px !important;
    min-height: 1.5em;
    color: var(--color-ink);
  }

  /* Headings */
  .prose h1 {
    font-size: 1.875rem;
    margin-top: 2rem !important;
    margin-bottom: 0.25rem !important;
    font-weight: 700;
    line-height: 1.3;
  }

  .prose h2 {
    font-size: 1.5rem;
    margin-top: 1.5rem !important;
    margin-bottom: 0.25rem !important;
    font-weight: 600;
    line-height: 1.3;
  }

  .prose h3 {
    font-size: 1.25rem;
    margin-top: 1rem !important;
    margin-bottom: 0.25rem !important;
    font-weight: 600;
    line-height: 1.3;
  }

  /* Blockquote - Notion Style */
  .prose blockquote {
    border-left-width: 3px;
    border-left-color: currentColor;
    background: transparent;
    padding-left: 1rem;
    margin-top: 0.5rem !important;
    margin-bottom: 0.5rem !important;
    font-style: normal;
    opacity: 0.8;
  }

  /* Code Block - Notion Style */
  .prose pre {
    background-color: var(--bg-surface);
    border-radius: 4px;
    padding: 2rem 1rem 1rem 1rem;
    margin-top: 0.5rem !important;
    margin-bottom: 0.5rem !important;
    color: #EB5757;
  }

  :is(.dark .prose pre) {
    background-color: var(--bg-surface);
  }

  /* Inline Code */
  .prose code {
    color: #EB5757;
    background-color: rgba(135, 131, 120, 0.15);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-weight: normal;
  }

  /* Lists */
  .prose ul {
    list-style-type: disc;
    padding-left: 1.5rem;
    margin-top: 0.25rem !important;
    margin-bottom: 0.25rem !important;
  }

  .prose ol {
    list-style-type: decimal;
    padding-left: 1.5rem;
    margin-top: 0.25rem !important;
    margin-bottom: 0.25rem !important;
  }

  .prose li {
    margin-top: 0.1em !important;
    margin-bottom: 0.1em !important;
    padding-left: 0.1em;
  }

  /* Task List */
  ul[data-type="taskList"] {
    list-style: none;
    padding: 0;
  }

  ul[data-type="taskList"] li {
    display: flex;
    align-items: flex-start;
  }

  ul[data-type="taskList"] li>label {
    margin-right: 0.5rem;
    user-select: none;
  }

  ul[data-type="taskList"] li>div {
    flex: 1;
  }

  /* Fix for alignment: Remove paragraph margins inside task list items */
  ul[data-type="taskList"] li p {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  /* Placeholder - Notion Style */
  .is-editor-empty:first-child::before {
    color: #adb5bd;
    content: attr(data-placeholder);
    float: left;
    height: 0;
    pointer-events: none;
  }

  /* Horizontal Rule - Notion Style */
  .prose :where(hr):not(:where([class~="not-prose"] *)) {
    margin-top: 2em;
    margin-bottom: 2em;
    border-top-width: 1px;
    border-color: rgba(55, 53, 47, 0.09);
  }

  :is(.dark .prose :where(hr):not(:where([class~="not-prose"] *))) {
    border-color: rgba(255, 255, 255, 0.13);
  }

  /* Table Styles */
  .prose table {
    border-collapse: collapse;
    margin: 0;
    overflow: hidden;
    table-layout: fixed;
    width: 100%;
    margin-top: 1.5em !important;
    margin-bottom: 1.5em !important;
  }

  .prose td,
  .prose th {
    border: 1px solid #e5e7eb;
    box-sizing: border-box;
    min-width: 1em;
    padding: 6px 8px;
    position: relative;
    vertical-align: top;
  }

  .prose th {
    background-color: var(--bg-surface);
    font-weight: 600;
    text-align: left;
  }

  :is(.dark .prose th) {
    background-color: var(--bg-surface);
    border-color: var(--border-base);
  }

  :is(.dark .prose td) {
    border-color: var(--border-base);
  }

  .prose .selectedCell:after {
    background: rgba(200, 200, 255, 0.4);
    content: "";
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    pointer-events: none;
    position: absolute;
    z-index: 2;
  }

  /* Syntax Highlighting (One Dark-ish) */
  .prose pre code {
    color: inherit;
    background-color: transparent;
    padding: 0;
    font-family: 'JetBrains Mono', monospace;
  }

  .hljs-comment,
  .hljs-quote {
    color: #a0a1a7;
    font-style: italic;
  }

  .hljs-doctag,
  .hljs-keyword,
  .hljs-formula {
    color: #a626a4;
  }

  .hljs-section,
  .hljs-name,
  .hljs-selector-tag,
  .hljs-deletion,
  .hljs-subst {
    color: #e45649;
  }

  .hljs-literal {
    color: #0184bc;
  }

  .hljs-string,
  .hljs-regexp,
  .hljs-addition,
  .hljs-attribute,
  .hljs-meta-string {
    color: #50a14f;
  }

  .hljs-built_in,
  .hljs-class .hljs-title {
    color: #c18401;
  }

  .hljs-attr,
  .hljs-variable,
  .hljs-template-variable,
  .hljs-type,
  .hljs-selector-class,
  .hljs-selector-attr,
  .hljs-selector-pseudo,
  .hljs-number {
    color: #986801;
  }

  .hljs-symbol,
  .hljs-bullet,
  .hljs-link,
  .hljs-meta,
  .hljs-selector-id,
  .hljs-title {
    color: #4078f2;
  }

  .hljs-emphasis {
    font-style: italic;
  }

  .hljs-strong {
    font-weight: bold;
  }

  .hljs-link {
    text-decoration: underline;
  }
}